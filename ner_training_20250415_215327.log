2025-04-15 21:53:27,104 - INFO - Using Apple MPS (Metal Performance Shaders)
2025-04-15 21:53:27,104 - INFO - Starting training with configuration:
2025-04-15 21:53:27,104 - INFO - {
    "model_name": "microsoft/deberta-v3-base",
    "batch_size": 4,
    "effective_batch_size": 16,
    "gradient_accumulation_steps": 4,
    "learning_rate": 2e-05,
    "num_epochs": 3,
    "max_len": 64,
    "gamma": 2.0,
    "temperature": 0.07,
    "gradient_checkpointing": true,
    "mixed_precision": true,
    "gradient_clip": 1.0,
    "timestamp": "2025-04-15 21:53:27"
}
2025-04-15 21:53:27,104 - INFO - Loading CoNLL-2003 dataset...
2025-04-15 21:53:32,613 - INFO - Dataset loaded successfully. Processing labels...
2025-04-15 21:53:34,196 - INFO - Applying data augmentation...
2025-04-15 21:53:34,855 - INFO - Encoding dataset with spans...
2025-04-15 21:53:40,056 - INFO - Dataset encoding completed successfully
2025-04-15 21:53:40,133 - INFO - Converting dataset to PyTorch tensors...
2025-04-15 21:54:35,135 - INFO - Dataset conversion completed successfully
2025-04-15 21:54:35,213 - INFO - Verifying dataset format...
2025-04-15 21:54:35,217 - INFO - Sample shapes:
2025-04-15 21:54:35,217 - INFO - Input IDs: torch.Size([64])
2025-04-15 21:54:35,217 - INFO - Attention Mask: torch.Size([64])
2025-04-15 21:54:35,217 - INFO - Span Labels: torch.Size([189])
2025-04-15 21:54:35,217 - INFO - 
Batch shapes:
2025-04-15 21:54:35,217 - INFO - Input IDs: torch.Size([4, 64])
2025-04-15 21:54:35,217 - INFO - Attention Mask: torch.Size([4, 64])
2025-04-15 21:54:35,217 - INFO - Span Labels: torch.Size([4, 189])
2025-04-15 21:54:35,294 - INFO - Initializing model...
2025-04-15 21:54:35,295 - INFO - Initializing SpanNER model...
2025-04-15 21:54:37,701 - INFO - SpanNER model initialized successfully
2025-04-15 21:54:37,914 - INFO - Initializing optimizer...
2025-04-15 21:54:37,915 - INFO - Initializing loss functions...
2025-04-15 21:54:37,915 - INFO - Pre-allocating memory for first batch...
2025-04-15 21:54:37,915 - INFO - Successfully loaded first batch
